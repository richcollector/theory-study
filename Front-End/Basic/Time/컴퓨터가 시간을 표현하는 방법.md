## 컴퓨터가 시간을 표현하는 방법

하드웨어의 시스템 클럭을 이용하여 특정 시각(Epoch)을 기준으로 클럭의 틱을 세는 것으로 구현됩니다.

이를 시스템 시간으로 부르고, 값으로 표현한 것을 타임스탬프(Timestamp)라고 부릅니다. 타임스탬프는 운영체제마다 기준 시간과 단위가 다를 수 있습니다.

유닉스 계열 운영체제에서 시간을 표시하는 방법을 Unix Time라고 부릅니다.

### 시스템 클럭의 원리

Rtc(Real Time Clock)라는 모듈이 메인보드에 붙어있어, 전원을 끄더라도 계속 작동합니다. 카운터회로를 통해 클럭을 발생시키는데, 핵심부품인 결정 진동자가 만드는 주파수를 이용합니다. 1클럭에 1초를 계산하기 쉬운 주파수인 32.768kHz가 발생합니다.

### 결정 진동자에 대한 자세한 내용

- UTC(세계 협정 시)

  원자 시계와 윤초 보정을 기반으로 표준화한 시각이며, 모든 시간을 UTC+0 기준으로 환산합니다. T는 Time을 의미하고, Z는 Zulu Time을 뜻합니다.
  경도 0(Zero)의 앞글자 z를 나타내고 z는 무선 통신 용어로 Zulu라고 표현됩니다.

```jsx
2021-03-20T09:00:00Z
// UTC+0기준 2021년 3월 20일 9시
2021-03-20T09:00:00+09:00
// UTC+9(한국시간) 기준 2021년 3월 20일 9시
```

- Unix Time

  1970년 1월 1일 0시 0분 0초가 기준 시각이며, 이전 시간은 음수로 표현된다. 초 단위로 시간이 증가하는 특징이 있다.

### 현재 시간은 어떻게 알아낼까?

시스템 시간을 네트워크 타임 프로토콜(NTP)를 통해 동기화 할 수 있고, NTP서버에 네트워크 요청을 하여 현재 시간을 받을 수 있습니다.

NTP서버는 계층으로 이루어져 있으며, 그 계층을 Stratum이라 부르고 최상위 계층은 PRC(Primary Reference Clock)라고 부릅니다.

### 그렇다면 시간대를 어떻게 고려해야할까?

Time zone 데이터를 활용하여 시간을 고려할 수 있습니다. 현실 세계에서 일광 시간 절약제나 어떠한 이벤트로 시간이 바뀌면 해당 데이터베이스에 저장이 됩니다.

표기법은 Asia/Seoul, America/New_York와 같이 대륙/도시 형태를 따르고 이 값을 Zoneid라고 부릅니다.

### 시간을 어떤 기준으로 사용해야 할까?

글로벌 서비스를 운영할 때 시간을 매우 중요한데, 사용되는 시간을 용도에 맞춰서 기록할 필요가 있습니다.

- UTC

  역사, 사회, 문화에 대한 맥락 없이 사건이 발생한 시각만을 고려할 때 사용합니다.
  **주식과 같은 시계열 데이터**

- Time Zone이 적용된 시간

  역사, 사회, 문화를 고려하여 이용한 시간을 정확히 알아야 할 때 사용합니다. UI에 표시되는 시간을 사용자 기준으로 보여줄 때 사용합니다.
  **결제 시각, 푸시 알림시간, UI 시각 표시, 캘린더**

### 코드로 보는 시간 정리

```jsx
  'userId': 1,
  'name': '김태완',
  'zoneId': '1991-01-05' // 순수한 시간
  'creatAt': '2023-10-08T04:59:25Z' // 기준 시간 UTC
  'updateAt': '2023-10-08T05:12:38Z'
  'posts': [
  {
  'postId': 1,
  'publishedAt': '2023-10-08T06:00:00Z',
  // 기준 시간 오전 6시에 발행
  //publishedAt은 user의 zoneId에 따라 다르게 보일 수 있다.
```
