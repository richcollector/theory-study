## CSRF(Cross Site Request Forgery, 사이트간 요청변조)

사용자가 의도치 않게 공격자가 의도한 행동을 하여 취약점을 노출시키거나 수정/삭제/생성 등을 하게 만드는 공격 기법입니다. 이메일을 열어보거나 악성 사이트에 접근했을 때 특정한 요청을 하는 CSRF 스크립트를 실행하는 방식입니다.
다음과 같은 시나리오가 있을 수 있습니다.

- www.mybank.com 에 접속해 있는 상태입니다.
- 이 사이트에서 돈을 보낼 때 http://www.mybank.com/transfer?to=<계좌번호>&amount=<액수> 형식으로 보낸다고 해봅시다.
- www.cute-cat.org 사이트에 접속합니다. (악성 사이트)
- 해당 사이트의 관리자가 위에서 말한 돈을 보내는 URL과 쿼리 방식을 알고 있다면 그 요청을 실행하는 CSRF 스크립트를 사이트에 넣을 수 있습니다.
- 사이트에 접속하면 해당 스크립트를 실행하게 되고 www.mybank.com 에 요청이 가게 되서 돈을 보내게 됩니다.
- 이렇게 사용자가 의도하지 않은 요청을 실행함으로 피해를 줄 수 있는 기법입니다.

### 대응방안

- referrer 검증

  요청 헤더에 있는 referrer 속성을 검증하여 신뢰할 수 있는 도메인에서 들어오는 요청인지 검증한다.

- CSRF 토큰

  난수(Random Number)를 서버쪽 사용자의 세션에 저장하고 요청할 때 난수를 CSRF 토큰으로 지정하여 사용자게 전송합니다. 이후 요청부터 토큰이 일치하는지 확인하여 검증한다.

- 캡챠(Captcha) 사용

  사용자와의 상호작용을 통해서 숫자/문자를 입력하여 검증한다.
